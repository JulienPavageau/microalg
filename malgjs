#!/usr/bin/env nodejs
fs = require('fs')

// Load EmuLisp and MicroAlg.
var content = '';
content = fs.readFileSync('emulisp/emulisp_core.js').toString();
eval(content);
content = fs.readFileSync('microalg.l').toString();
EMULISP_CORE.eval(content);

// To REPL or not to REPL:
var script = process.argv[2];
if (typeof script == 'undefined') {
    // No arg: start REPL.
    var prompt = require('sync-prompt').prompt;
    var user_input = prompt(': ');
    while (user_input != '(bye)') {
        EMULISP_CORE.eval(user_input);
        user_input = prompt(': ');
    }
} else {
    // File interpreter.
    content = fs.readFileSync(process.argv[2]).toString();
    EMULISP_CORE.eval(content);
}

